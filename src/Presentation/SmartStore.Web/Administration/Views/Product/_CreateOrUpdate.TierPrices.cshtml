@model ProductModel

@using Telerik.Web.Mvc.UI;

@if (Model.Id > 0)
{
    @(Html.Telerik().Grid<ProductModel.TierPriceModel>()
        .Name("tierprices-grid")
        .DataKeys(keys =>
        {
            keys.Add(x => x.Id);
        })
        .DataBinding(dataBinding =>
        {
            dataBinding.Ajax()
                .Select("TierPriceList", "Product", new { productId = Model.Id })
                .Insert("TierPriceInsert", "Product", new { productId = Model.Id })
                .Update("TierPriceUpdate", "Product")
                .Delete("TierPriceDelete", "Product");
        })
        .Columns(columns =>
        {
            columns.Bound(x => x.Store)
                    .Centered();
            columns.Bound(x => x.CustomerRole)
                .Centered();
            columns.Bound(x => x.Quantity)
                .Centered();
            columns.Bound(x => x.Price1)
                .Format("{0:G29}");
            columns.Command(commands =>
            {
                commands.Edit().Localize(T);
                commands.Delete().Localize(T);
            })
            .Width(180);
        })
        .ToolBar(commands => commands.Insert())
        .ClientEvents(events => events.OnEdit("onTierPriceEdit"))
        .EnableCustomBinding(true))

    <script type="text/javascript">
        function onTierPriceEdit(e) {
            // codehint: sm-edit
            $(e.form).find('#CustomerRole').select2('val', e.dataItem['CustomerRoleId']);
        }
    </script>
}
else
{
    @T("Admin.Catalog.Products.TierPrices.SaveBeforeEdit")
}
